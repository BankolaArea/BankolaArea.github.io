<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CBA Acquisition Process</title>
    <style>
        /* 
           ========================================
           CSS VARIABLES (THEME)
           ========================================
        */
        :root {
            --primary: #8b5cf6;
            /* Violet for CBA to distinguish from Direct Purchase Blue */
            --success: #10b981;
            /* Emerald Green */
            --danger: #ef4444;
            /* Red */
            --warning: #f59e0b;
            /* Amber */
            --dark: #1e293b;
            /* Slate 800 */
            --light: #f8fafc;
            /* Slate 50 */
            --white: #ffffff;
        }

        /* DIRECT PURCHASE CSS PRESERVED AND ADAPTED */
        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background: #0f172a;
            color: var(--dark);
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
        }

        #app {
            width: 100%;
            max-width: 500px;
            background: var(--light);
            height: 100%;
            display: flex;
            flex-direction: column;
            position: relative;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            overflow: hidden;
        }

        header {
            background: var(--primary);
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: bold;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            z-index: 10;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .screen {
            flex: 1;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            text-align: center;
            overflow-y: auto;
            position: relative;
        }

        .screen.active {
            display: flex;
            animation: fadeIn 0.4s ease-out;
        }

        .emoji-icon {
            font-size: 4rem;
            margin: 10px;
            display: inline-block;
        }

        h1 {
            font-size: 1.6rem;
            color: var(--primary);
            margin: 0.5rem 0;
        }

        h2 {
            font-size: 1.3rem;
            color: var(--dark);
            margin: 0.5rem 0;
        }

        p {
            font-size: 1rem;
            color: #475569;
            line-height: 1.5;
            margin: 10px 0 20px 0;
        }

        .btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 15px 25px;
            font-size: 1.1rem;
            font-weight: bold;
            border-radius: 12px;
            cursor: pointer;
            width: 90%;
            margin: 10px 0;
            box-shadow: 0 4px 0 #5b21b6;
            /* Darker violet */
            transition: transform 0.1s;
        }

        .btn:active {
            transform: translateY(4px);
            box-shadow: none;
        }

        .btn-green {
            background: var(--success);
            box-shadow: 0 4px 0 #047857;
        }

        .btn-green:active {
            box-shadow: none;
        }

        .btn-red {
            background: var(--danger);
            box-shadow: 0 4px 0 #b91c1c;
        }

        .btn-red:active {
            box-shadow: none;
        }

        .btn-warning {
            background: var(--warning);
            color: white;
            box-shadow: 0 4px 0 #d97706;
        }

        .btn-warning:active {
            box-shadow: none;
        }

        .btn-outline {
            background: white;
            color: var(--primary);
            border: 2px solid var(--primary);
            box-shadow: none;
        }

        .doc-area {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
            justify-content: center;
        }

        .doc-card {
            border: 2px solid #94a3b8;
            padding: 10px;
            border-radius: 8px;
            background: white;
            width: 140px;
            position: relative;
            font-size: 0.9rem;
            cursor: pointer;
        }

        .doc-card .icon {
            font-size: 2rem;
            display: block;
            margin-bottom: 5px;
        }

        #modal-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 100;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 400px;
            text-align: center;
            animation: popUp 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .modal-icon {
            font-size: 3rem;
            margin-bottom: 10px;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes popUp {
            from {
                transform: scale(0.5);
                opacity: 0;
            }

            to {
                transform: scale(1);
                opacity: 1;
            }
        }
    </style>
</head>

<body>

    <div id="app">
        <header>
            <span id="header-phase">Intro</span>
            <button id="btn-voice" onclick="voice.toggle()"
                style="background:none; border:none; font-size:1.2rem; cursor:pointer; color:white;">üîä</button>
        </header>

        <!-- INTRO SCREEN -->
        <div id="screen-intro" class="screen active">
            <h1>CBA Acquisition Bankola Area</h1>
            <div class="emoji-icon">‚õèÔ∏è‚ö°üìú</div>
            <h2>Coal Bearing Areas Act, 1957</h2>
            <p>Through this you will get an overview of the process of land acquisition by CBA.</p>
            <button class="btn btn-green" onclick="game.start()">Start Proposal</button>
        </div>

        <!-- PHASE 1: NOTIFICATION -->
        <div id="screen-p1" class="screen">
            <h2>Phase 1: Notification</h2>
            <p><strong>Goal:</strong> Secure Legal Mandate (Section 4, 7, 9, 11) of CBA Act.</p>

            <div class="doc-area">
                <div class="doc-card"
                    onclick="modal.show('Reconciliation', '<strong>Form-VII</strong><br>Ensures no overlap with other mines.', 'üó∫Ô∏è')">
                    <span class="icon">üó∫Ô∏è</span>Form-VII
                </div>
                <div class="doc-card"
                    onclick="modal.show('Details', '<strong>Forms 1A to 1D</strong><br>Coal availability and land details.', 'üìÑ')">
                    <span class="icon">üìÑ</span>Forms 1A to 1D
                </div>
            </div>

            <p><strong>Step 1: Initiation</strong><br>Mine -> Area -> HQ Proposal</p>
            <button class="btn btn-outline" id="btn-p1-init" onclick="phase1.initiate()">Submit Proposal</button>

            <div id="p1-notify-flow" style="display:none; width:100%; text-align:center;">
                <p><strong>Step 2: Gazette Notifications</strong></p>

                <button class="btn btn-warning" id="btn-n4" onclick="phase1.notify4()">Issue Section 4(1)</button>
                <button class="btn btn-warning" id="btn-n7" style="display:none;" onclick="phase1.notify7()">Issue
                    Section 7(1)</button>
                <button class="btn btn-warning" id="btn-n9" style="display:none;" onclick="phase1.notify9()">Issue
                    Section 9(1)</button>
                <button class="btn btn-red" id="btn-n11" style="display:none;" onclick="phase1.notify11()">Issue Section
                    11(1)</button>
            </div>
        </div>

        <!-- PHASE 2: CLAIMS -->
        <div id="screen-p2" class="screen">
            <h2>Phase 2: Claim Processing</h2>
            <p><strong>Goal:</strong> Verify Ownership & Claims of the Land Owners.</p>

            <div class="doc-area">
                <div class="doc-card"
                    onclick="modal.show('Public Notice', '<strong>Form-III</strong><br>Abstract of acquired land published.', 'üì¢')">
                    <span class="icon">üì¢</span>Form-III
                </div>
                <div class="doc-card"
                    onclick="modal.show('Claim Application', '<strong>Form-I</strong><br>Landowner claim with Bank Details.', 'üìù')">
                    <span class="icon">üìù</span>Form-I
                </div>
            </div>

            <p><strong>Step 1: Invite Claims</strong></p>
            <button class="btn btn-outline" onclick="phase2.publish()">Publish Form-III</button>

            <div id="p2-verify-flow" style="display:none; width:100%;">
                <p><strong>Step 2: Verification</strong></p>
                <button class="btn btn-warning" onclick="phase2.verify()">Verify Claims (Form-I)</button>
            </div>

            <div id="p2-legal-flow" style="display:none; width:100%;">
                <p><strong>Step 3: Legal Search</strong><br>Check title as of Sec 9 date.</p>
                <button class="btn btn-green" onclick="phase2.legalSearch()">Run 30-Year Search</button>
            </div>
        </div>

        <!-- PHASE 3: COMPENSATION -->
        <div id="screen-p3" class="screen">
            <h2>Phase 3: Compensation</h2>
            <p><strong>Goal:</strong> Award Calculation & Payment.</p>

            <div class="doc-area">
                <div class="doc-card"
                    onclick="modal.show('Calculation', '<strong>Payroll</strong><br>Market/Negotiated value.', 'üßÆ')">
                    <span class="icon">üßÆ</span>Payroll
                </div>
            </div>

            <p><strong>Step 1: Prepare Award</strong></p>
            <button class="btn btn-outline" onclick="phase3.prepare()">Prepare Payroll</button>

            <div id="p3-pay-flow" style="display:none; width:100%;">
                <p><strong>Step 2: Publication</strong></p>
                <button class="btn btn-warning" onclick="phase3.publish()">Publish Award</button>
            </div>

            <div id="p3-rtgs-flow" style="display:none; width:100%;">
                <p><strong>Step 3: Disbursement</strong></p>
                <button class="btn btn-green" onclick="phase3.pay()">Release Payment (RTGS)</button>
            </div>
        </div>

        <!-- PHASE 4: POSSESSION -->
        <div id="screen-p4" class="screen">
            <h2>Phase 4: Possession</h2>
            <p><strong>Goal:</strong> Physical Possession & Digitization.</p>

            <div class="doc-area">
                <div class="doc-card"
                    onclick="modal.show('Possession', '<strong>Form-IV</strong><br>Signed by Landowner & ECL Authority.', 'üö©')">
                    <span class="icon">üö©</span>Form-IV
                </div>
            </div>

            <div id="p4-possession-flow">
                <p><strong>Step 1: Physical Takeover</strong></p>
                <button class="btn btn-red" onclick="phase4.possess()">Take Physical Possession</button>
            </div>

            <div id="p4-update-flow" style="display:none; width:100%;">
                <p><strong>Step 2: Records</strong><br>Update Registers (Unit/Area).</p>
                <button class="btn btn-outline" onclick="phase4.updateRegisters()">Update Registers</button>
            </div>

            <div id="p4-digitize-flow" style="display:none; width:100%;">
                <p><strong>Step 3: Digitization</strong><br>GIS Mapping & Portal Upload.</p>
                <button class="btn btn-green" onclick="phase4.digitize()">Digitize (Coal RR/Gati-Shakti)</button>
            </div>
        </div>

        <!-- END SCREEN -->
        <div id="screen-end" class="screen">
            <div class="emoji-icon">üéâüè≠‚úÖ</div>
            <h1>Acquisition Complete!</h1>
            <p>Successfully acquired land under CBA Act 1957.</p>
            <p><strong>Summary:</strong> Proposal -> Notifications (4,7,9,11) -> Claims -> Verification -> Payment ->
                Possession -> Digitization.</p>
            <button class="btn" onclick="location.reload()">üîÑ Replay</button>
        </div>

    </div>

    <!-- MODAL -->
    <div id="modal-overlay">
        <div class="modal-content">
            <div class="modal-icon" id="modal-icon">üí°</div>
            <h2 id="modal-title">Info</h2>
            <p id="modal-text">Details...</p>
            <button class="btn btn-outline" onclick="modal.dismiss()" style="margin-bottom:10px;">Go Back</button>
            <button class="btn" onclick="modal.close()">Continue</button>
        </div>
    </div>

    <script>
        // --- CORE GAME ENGINE ---
        const game = {
            start: () => {
                game.setHeader('1. Notifications');
                game.next('screen-intro', 'screen-p1');
            },
            next: (from, to) => {
                document.getElementById(from).classList.remove('active');
                document.getElementById(to).classList.add('active');

                const h2 = document.getElementById(to).querySelector('h2');
                const p = document.getElementById(to).querySelector('p');
                let text = (h2 ? h2.innerText : "") + ". " + (p ? p.innerText : "");
                voice.speak(text);
            },
            setHeader: (text) => document.getElementById('header-phase').innerText = text
        };

        // --- MODAL CONTROLLER ---
        const modal = {
            callback: null,
            show: (title, text, icon, cb) => {
                document.getElementById('modal-title').innerText = title;
                document.getElementById('modal-text').innerHTML = text;
                document.getElementById('modal-icon').innerText = icon || 'üí°';
                document.getElementById('modal-overlay').style.display = 'flex';
                modal.callback = cb;
                voice.speak(title + ". " + text);
            },
            dismiss: () => {
                document.getElementById('modal-overlay').style.display = 'none';
                voice.stop();
                modal.callback = null;
            },
            close: () => {
                document.getElementById('modal-overlay').style.display = 'none';
                voice.stop();
                if (modal.callback) {
                    const cb = modal.callback;
                    modal.callback = null;
                    cb();
                }
            }
        };

        // --- TEXT TO SPEECH ---
        const voice = {
            enabled: true,
            toggle: () => {
                voice.enabled = !voice.enabled;
                document.getElementById('btn-voice').innerText = voice.enabled ? 'üîä' : 'üîá';
            },
            speak: (text) => {
                if (!voice.enabled || !('speechSynthesis' in window)) return;
                window.speechSynthesis.cancel();

                // Pronunciation Fixes
                text = text.replace(/Form-I\b/g, "Form One");
                text = text.replace(/Form-III\b/g, "Form Three");
                text = text.replace(/Form-IV\b/g, "Form Four");
                text = text.replace(/Form-VII\b/g, "Form Seven");
                text = text.replace(/Section 4/g, "Section Four");
                text = text.replace(/Section 7/g, "Section Seven");
                text = text.replace(/Section 9/g, "Section Nine");
                text = text.replace(/Section 11/g, "Section Eleven");
                text = text.replace(/CBA/g, "C B A");
                text = text.replace(/ECL/g, "E C L");
                text = text.replace(/RTGS/g, "R T G S");
                text = text.replace(/AGM/g, "Area G M");
                text = text.replace(/LRE/g, "Land Revenue Estate");
                text = text.replace(/RFCTLARR/g, "Fair Compensation Act"); // Simplify for audio
                text = text.replace(/<[^>]*>/g, " ");

                const u = new SpeechSynthesisUtterance(text);
                window.speechSynthesis.speak(u);
            },
            stop: () => window.speechSynthesis.cancel()
        };

        // --- PHASE LOGIC ---

        const phase1 = {
            initiate: () => {
                modal.show(
                    "Proposal Initiated",
                    "Mine Mgmt prepared Schedule.<br>Vetted by Area Land Cell.<br>Forwarded by Area General Manager to General Manager (LRE) at ECL, HQ.",
                    "üì§",
                    () => {
                        document.getElementById('btn-p1-init').style.display = 'none';
                        document.getElementById('p1-notify-flow').style.display = 'block';
                    }
                );
            },
            notify4: () => {
                modal.show(
                    "Section 4(1) Notification",
                    "<strong>Intention to Prospect.</strong><br>Published in Gazette.<br>Valid for 2 years (extendable +1).",
                    "üì¢",
                    () => {
                        document.getElementById('btn-n4').style.display = 'none';
                        document.getElementById('btn-n7').style.display = 'inline-block';
                    }
                );
            },
            notify7: () => {
                modal.show(
                    "Section 7(1) Notification",
                    "<strong>Intention to Acquire.</strong><br>Objections invited from 'Persons Affected' (30 days).<br>Survey Started.",
                    "‚ö†Ô∏è",
                    () => {
                        document.getElementById('btn-n7').style.display = 'none';
                        document.getElementById('btn-n9').style.display = 'inline-block';
                    }
                );
            },
            notify9: () => {
                modal.show(
                    "Section 9(1) Declared",
                    "<strong>Declaration of Acquisition.</strong><br>Government notifies the land to be acquired.<br><strong>Action:</strong> Drone Survey to be done by the ECL to freeze assets and structures.",
                    "üöÅ",
                    () => {
                        document.getElementById('btn-n9').style.display = 'none';
                        document.getElementById('btn-n11').style.display = 'inline-block';
                    }
                );
            },
            notify11: () => {
                modal.show(
                    "Section 11(1) Vesting",
                    "<strong>Vested Absolutely.</strong><br>Land now belongs to ECL free from all encumbrances.<br>Title is transferred.",
                    "üèõÔ∏è",
                    () => {
                        game.setHeader("2. Claim Processing");
                        game.next('screen-p1', 'screen-p2');
                    }
                );
            }
        };

        const phase2 = {
            publish: () => {
                modal.show(
                    "Form-III Published",
                    "Abstract of land published on Website & Newspapers.<br>Inviting claims from public.",
                    "üì∞",
                    () => {
                        document.getElementById('p2-verify-flow').style.display = 'block';
                    }
                );
            },
            verify: () => {
                modal.show(
                    "Claims Received",
                    "Landowners submitted <strong>Form-I</strong> with Aadhaar, Deeds, & Bank Info.<br>Claims reconciled.",
                    "üßê",
                    () => {
                        document.getElementById('p2-verify-flow').style.display = 'none';
                        document.getElementById('p2-legal-flow').style.display = 'block';
                    }
                );
            },
            legalSearch: () => {
                modal.show(
                    "Legal Verification",
                    "Lawyer verified Title <strong>as of Section 9 Notification date</strong>.<br>30 Years Search Report clean.",
                    "‚öñÔ∏è",
                    () => {
                        game.setHeader("3. Compensation");
                        game.next('screen-p2', 'screen-p3');
                    }
                );
            }
        };

        const phase3 = {
            prepare: () => {
                modal.show(
                    "Payroll Ready",
                    "Value (Market/Negociated) finalized.<br>Vetted by Area Authority -> HQ -> Competent Authority (CMD/Board).",
                    "üìä",
                    () => {
                        document.getElementById('p3-pay-flow').style.display = 'block';
                    }
                );
            },
            publish: () => {
                modal.show(
                    "Award Published",
                    "Award amount declared.<br>Notice issued to landowners to handover possession.",
                    "üì¢",
                    () => {
                        document.getElementById('p3-pay-flow').style.display = 'none';
                        document.getElementById('p3-rtgs-flow').style.display = 'block';
                    }
                );
            },
            pay: () => {
                modal.show(
                    "Payment Released",
                    "Paid via <strong>RTGS</strong> to beneficiaries.<br>Disputed amounts deposited in Tribunal.",
                    "üí∏",
                    () => {
                        game.setHeader("4. Possession");
                        game.next('screen-p3', 'screen-p4');
                    }
                );
            }
        };

        const phase4 = {
            possess: () => {
                modal.show(
                    "Physical Possession",
                    "<strong>Form-IV</strong> signed on the field.<br>Physical possession taken immediately after payment.",
                    "üö©",
                    () => {
                        document.getElementById('p4-update-flow').style.display = 'block';
                    }
                );
            },
            updateRegisters: () => {
                modal.show(
                    "Physical Registers will be Updated",
                    "Unit to be recorded in 3 days.<br>Area to be recorded in 7 days.<br>Bound Paged Book will be updated.",
                    "üìñ",
                    () => {
                        document.getElementById('p4-update-flow').style.display = 'none';
                        document.getElementById('p4-digitize-flow').style.display = 'block';
                    }
                );
            },
            digitize: () => {
                modal.show(
                    "Digitization Complete",
                    "Uploaded to <strong>Coal RR Portal</strong>.<br>KML mapped on <strong>GLIS/Gati-Shakti</strong>.",
                    "üåê",
                    () => {
                        game.next('screen-p4', 'screen-end');
                    }
                );
            }
        };

    </script>
</body>

</html>